{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.encode = void 0;\nexports.patch = patch;\nconst light_1 = require(\"protobufjs/light\");\nconst utils_1 = require(\"./utils\");\nconst transform = (fieldType, value) => {\n  if (fieldType === 'bytes') {\n    if (typeof value === 'string' && !value) return value;\n    return Buffer.from(value, 'hex');\n  }\n  if (typeof value === 'number' && !Number.isSafeInteger(value)) {\n    throw new RangeError('field value is not within safe integer range');\n  }\n  return value;\n};\nfunction patch(Message, payload) {\n  const patched = {};\n  if (!Message.fields) {\n    return patched;\n  }\n  Object.keys(Message.fields).forEach(key => {\n    const field = Message.fields[key];\n    const value = payload[key];\n    if (typeof value === 'undefined') {\n      return;\n    }\n    if ((0, utils_1.isPrimitiveField)(field.type)) {\n      if (field.repeated) {\n        patched[key] = value.map(v => transform(field.type, v));\n      } else {\n        patched[key] = transform(field.type, value);\n      }\n      return;\n    }\n    if (field.repeated) {\n      const fieldType = Message.lookupTypeOrEnum(field.type);\n      if (fieldType instanceof light_1.Enum) {\n        patched[key] = value;\n      } else {\n        patched[key] = value.map(v => patch(fieldType, v));\n      }\n    } else if (typeof value === 'object' && value !== null) {\n      const RefMessage = Message.lookupType(field.type);\n      patched[key] = patch(RefMessage, value);\n    } else if (typeof value === 'number') {\n      const RefMessage = Message.lookupEnum(field.type);\n      patched[key] = RefMessage.values[value];\n    } else {\n      patched[key] = value;\n    }\n  });\n  return patched;\n}\nconst encode = (Message, data) => {\n  const payload = patch(Message, data);\n  const message = Message.fromObject(payload);\n  const bytes = Message.encode(message).finish();\n  return Buffer.from(bytes);\n};\nexports.encode = encode;","map":{"version":3,"names":["Object","defineProperty","exports","value","encode","patch","light_1","require","utils_1","transform","fieldType","Buffer","from","Number","isSafeInteger","RangeError","Message","payload","patched","fields","keys","forEach","key","field","isPrimitiveField","type","repeated","map","v","lookupTypeOrEnum","Enum","RefMessage","lookupType","lookupEnum","values","data","message","fromObject","bytes","finish"],"sources":["/Users/papa/Desktop/trenchboard/trenchboard.io/node_modules/@trezor/protobuf/lib/encode.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.encode = void 0;\nexports.patch = patch;\nconst light_1 = require(\"protobufjs/light\");\nconst utils_1 = require(\"./utils\");\nconst transform = (fieldType, value) => {\n    if (fieldType === 'bytes') {\n        if (typeof value === 'string' && !value)\n            return value;\n        return Buffer.from(value, 'hex');\n    }\n    if (typeof value === 'number' && !Number.isSafeInteger(value)) {\n        throw new RangeError('field value is not within safe integer range');\n    }\n    return value;\n};\nfunction patch(Message, payload) {\n    const patched = {};\n    if (!Message.fields) {\n        return patched;\n    }\n    Object.keys(Message.fields).forEach(key => {\n        const field = Message.fields[key];\n        const value = payload[key];\n        if (typeof value === 'undefined') {\n            return;\n        }\n        if ((0, utils_1.isPrimitiveField)(field.type)) {\n            if (field.repeated) {\n                patched[key] = value.map((v) => transform(field.type, v));\n            }\n            else {\n                patched[key] = transform(field.type, value);\n            }\n            return;\n        }\n        if (field.repeated) {\n            const fieldType = Message.lookupTypeOrEnum(field.type);\n            if (fieldType instanceof light_1.Enum) {\n                patched[key] = value;\n            }\n            else {\n                patched[key] = value.map((v) => patch(fieldType, v));\n            }\n        }\n        else if (typeof value === 'object' && value !== null) {\n            const RefMessage = Message.lookupType(field.type);\n            patched[key] = patch(RefMessage, value);\n        }\n        else if (typeof value === 'number') {\n            const RefMessage = Message.lookupEnum(field.type);\n            patched[key] = RefMessage.values[value];\n        }\n        else {\n            patched[key] = value;\n        }\n    });\n    return patched;\n}\nconst encode = (Message, data) => {\n    const payload = patch(Message, data);\n    const message = Message.fromObject(payload);\n    const bytes = Message.encode(message).finish();\n    return Buffer.from(bytes);\n};\nexports.encode = encode;\n//# sourceMappingURL=encode.js.map"],"mappings":"AAAA,YAAY;;AACZA,MAAM,CAACC,cAAc,CAACC,OAAO,EAAE,YAAY,EAAE;EAAEC,KAAK,EAAE;AAAK,CAAC,CAAC;AAC7DD,OAAO,CAACE,MAAM,GAAG,KAAK,CAAC;AACvBF,OAAO,CAACG,KAAK,GAAGA,KAAK;AACrB,MAAMC,OAAO,GAAGC,OAAO,CAAC,kBAAkB,CAAC;AAC3C,MAAMC,OAAO,GAAGD,OAAO,CAAC,SAAS,CAAC;AAClC,MAAME,SAAS,GAAGA,CAACC,SAAS,EAAEP,KAAK,KAAK;EACpC,IAAIO,SAAS,KAAK,OAAO,EAAE;IACvB,IAAI,OAAOP,KAAK,KAAK,QAAQ,IAAI,CAACA,KAAK,EACnC,OAAOA,KAAK;IAChB,OAAOQ,MAAM,CAACC,IAAI,CAACT,KAAK,EAAE,KAAK,CAAC;EACpC;EACA,IAAI,OAAOA,KAAK,KAAK,QAAQ,IAAI,CAACU,MAAM,CAACC,aAAa,CAACX,KAAK,CAAC,EAAE;IAC3D,MAAM,IAAIY,UAAU,CAAC,8CAA8C,CAAC;EACxE;EACA,OAAOZ,KAAK;AAChB,CAAC;AACD,SAASE,KAAKA,CAACW,OAAO,EAAEC,OAAO,EAAE;EAC7B,MAAMC,OAAO,GAAG,CAAC,CAAC;EAClB,IAAI,CAACF,OAAO,CAACG,MAAM,EAAE;IACjB,OAAOD,OAAO;EAClB;EACAlB,MAAM,CAACoB,IAAI,CAACJ,OAAO,CAACG,MAAM,CAAC,CAACE,OAAO,CAACC,GAAG,IAAI;IACvC,MAAMC,KAAK,GAAGP,OAAO,CAACG,MAAM,CAACG,GAAG,CAAC;IACjC,MAAMnB,KAAK,GAAGc,OAAO,CAACK,GAAG,CAAC;IAC1B,IAAI,OAAOnB,KAAK,KAAK,WAAW,EAAE;MAC9B;IACJ;IACA,IAAI,CAAC,CAAC,EAAEK,OAAO,CAACgB,gBAAgB,EAAED,KAAK,CAACE,IAAI,CAAC,EAAE;MAC3C,IAAIF,KAAK,CAACG,QAAQ,EAAE;QAChBR,OAAO,CAACI,GAAG,CAAC,GAAGnB,KAAK,CAACwB,GAAG,CAAEC,CAAC,IAAKnB,SAAS,CAACc,KAAK,CAACE,IAAI,EAAEG,CAAC,CAAC,CAAC;MAC7D,CAAC,MACI;QACDV,OAAO,CAACI,GAAG,CAAC,GAAGb,SAAS,CAACc,KAAK,CAACE,IAAI,EAAEtB,KAAK,CAAC;MAC/C;MACA;IACJ;IACA,IAAIoB,KAAK,CAACG,QAAQ,EAAE;MAChB,MAAMhB,SAAS,GAAGM,OAAO,CAACa,gBAAgB,CAACN,KAAK,CAACE,IAAI,CAAC;MACtD,IAAIf,SAAS,YAAYJ,OAAO,CAACwB,IAAI,EAAE;QACnCZ,OAAO,CAACI,GAAG,CAAC,GAAGnB,KAAK;MACxB,CAAC,MACI;QACDe,OAAO,CAACI,GAAG,CAAC,GAAGnB,KAAK,CAACwB,GAAG,CAAEC,CAAC,IAAKvB,KAAK,CAACK,SAAS,EAAEkB,CAAC,CAAC,CAAC;MACxD;IACJ,CAAC,MACI,IAAI,OAAOzB,KAAK,KAAK,QAAQ,IAAIA,KAAK,KAAK,IAAI,EAAE;MAClD,MAAM4B,UAAU,GAAGf,OAAO,CAACgB,UAAU,CAACT,KAAK,CAACE,IAAI,CAAC;MACjDP,OAAO,CAACI,GAAG,CAAC,GAAGjB,KAAK,CAAC0B,UAAU,EAAE5B,KAAK,CAAC;IAC3C,CAAC,MACI,IAAI,OAAOA,KAAK,KAAK,QAAQ,EAAE;MAChC,MAAM4B,UAAU,GAAGf,OAAO,CAACiB,UAAU,CAACV,KAAK,CAACE,IAAI,CAAC;MACjDP,OAAO,CAACI,GAAG,CAAC,GAAGS,UAAU,CAACG,MAAM,CAAC/B,KAAK,CAAC;IAC3C,CAAC,MACI;MACDe,OAAO,CAACI,GAAG,CAAC,GAAGnB,KAAK;IACxB;EACJ,CAAC,CAAC;EACF,OAAOe,OAAO;AAClB;AACA,MAAMd,MAAM,GAAGA,CAACY,OAAO,EAAEmB,IAAI,KAAK;EAC9B,MAAMlB,OAAO,GAAGZ,KAAK,CAACW,OAAO,EAAEmB,IAAI,CAAC;EACpC,MAAMC,OAAO,GAAGpB,OAAO,CAACqB,UAAU,CAACpB,OAAO,CAAC;EAC3C,MAAMqB,KAAK,GAAGtB,OAAO,CAACZ,MAAM,CAACgC,OAAO,CAAC,CAACG,MAAM,CAAC,CAAC;EAC9C,OAAO5B,MAAM,CAACC,IAAI,CAAC0B,KAAK,CAAC;AAC7B,CAAC;AACDpC,OAAO,CAACE,MAAM,GAAGA,MAAM","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}