{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect, useCallback } from 'react';\nimport websocketService from '../utils/websocket';\nconst useNewCoinsData = () => {\n  _s();\n  const [data, setData] = useState({\n    coins: [],\n    loading: true,\n    error: null\n  });\n  const handleWebSocketMessage = useCallback(message => {\n    console.log('WebSocket message received:', message);\n    if (message.type === 'newToken') {\n      console.log('New token data:', message.data);\n      setData(prevData => {\n        // Check if we already have this token address\n        const isDuplicate = prevData.coins.some(coin => coin.address === message.data.address);\n        if (isDuplicate) {\n          return prevData;\n        }\n\n        // Add new token to the list\n        const newCoins = [{\n          name: message.data.name,\n          address: message.data.address,\n          createdAt: message.data.timestamp,\n          initialPrice: message.data.initialPrice,\n          initialLiquidity: message.data.initialLiquidity\n        }, ...prevData.coins].slice(0, 5); // Keep only the 5 most recent coins\n\n        return {\n          coins: newCoins,\n          loading: false,\n          error: null\n        };\n      });\n    }\n  }, []);\n  useEffect(() => {\n    console.log('Setting up WebSocket connection...');\n    // Generate a unique ID for this subscriber\n    const subscriberId = Math.random().toString(36).substr(2, 9);\n\n    // Subscribe to WebSocket updates\n    websocketService.subscribe(subscriberId, handleWebSocketMessage);\n\n    // Set initial loading state to false since we'll get immediate mock data\n    setData(prevData => ({\n      ...prevData,\n      loading: false\n    }));\n\n    // Cleanup: unsubscribe when component unmounts\n    return () => {\n      console.log('Cleaning up WebSocket connection...');\n      websocketService.unsubscribe(subscriberId);\n    };\n  }, [handleWebSocketMessage]);\n\n  // Log whenever data changes\n  useEffect(() => {\n    console.log('Current coins state:', data.coins);\n  }, [data.coins]);\n  return data;\n};\n_s(useNewCoinsData, \"/72HTgPWJ8eCu2o9110bY5QvkBg=\");\nexport default useNewCoinsData;","map":{"version":3,"names":["useState","useEffect","useCallback","websocketService","useNewCoinsData","_s","data","setData","coins","loading","error","handleWebSocketMessage","message","console","log","type","prevData","isDuplicate","some","coin","address","newCoins","name","createdAt","timestamp","initialPrice","initialLiquidity","slice","subscriberId","Math","random","toString","substr","subscribe","unsubscribe"],"sources":["/Users/papa/Desktop/trenchboard/trenchboard.io/src/hooks/useNewCoinsData.js"],"sourcesContent":["import { useState, useEffect, useCallback } from 'react';\nimport websocketService from '../utils/websocket';\n\nconst useNewCoinsData = () => {\n  const [data, setData] = useState({\n    coins: [],\n    loading: true,\n    error: null\n  });\n\n  const handleWebSocketMessage = useCallback((message) => {\n    console.log('WebSocket message received:', message);\n    if (message.type === 'newToken') {\n      console.log('New token data:', message.data);\n      setData(prevData => {\n        // Check if we already have this token address\n        const isDuplicate = prevData.coins.some(\n          coin => coin.address === message.data.address\n        );\n\n        if (isDuplicate) {\n          return prevData;\n        }\n\n        // Add new token to the list\n        const newCoins = [\n          {\n            name: message.data.name,\n            address: message.data.address,\n            createdAt: message.data.timestamp,\n            initialPrice: message.data.initialPrice,\n            initialLiquidity: message.data.initialLiquidity\n          },\n          ...prevData.coins\n        ].slice(0, 5); // Keep only the 5 most recent coins\n\n        return {\n          coins: newCoins,\n          loading: false,\n          error: null\n        };\n      });\n    }\n  }, []);\n\n  useEffect(() => {\n    console.log('Setting up WebSocket connection...');\n    // Generate a unique ID for this subscriber\n    const subscriberId = Math.random().toString(36).substr(2, 9);\n\n    // Subscribe to WebSocket updates\n    websocketService.subscribe(subscriberId, handleWebSocketMessage);\n\n    // Set initial loading state to false since we'll get immediate mock data\n    setData(prevData => ({\n      ...prevData,\n      loading: false\n    }));\n\n    // Cleanup: unsubscribe when component unmounts\n    return () => {\n      console.log('Cleaning up WebSocket connection...');\n      websocketService.unsubscribe(subscriberId);\n    };\n  }, [handleWebSocketMessage]);\n\n  // Log whenever data changes\n  useEffect(() => {\n    console.log('Current coins state:', data.coins);\n  }, [data.coins]);\n\n  return data;\n};\n\nexport default useNewCoinsData;"],"mappings":";AAAA,SAASA,QAAQ,EAAEC,SAAS,EAAEC,WAAW,QAAQ,OAAO;AACxD,OAAOC,gBAAgB,MAAM,oBAAoB;AAEjD,MAAMC,eAAe,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAC5B,MAAM,CAACC,IAAI,EAAEC,OAAO,CAAC,GAAGP,QAAQ,CAAC;IAC/BQ,KAAK,EAAE,EAAE;IACTC,OAAO,EAAE,IAAI;IACbC,KAAK,EAAE;EACT,CAAC,CAAC;EAEF,MAAMC,sBAAsB,GAAGT,WAAW,CAAEU,OAAO,IAAK;IACtDC,OAAO,CAACC,GAAG,CAAC,6BAA6B,EAAEF,OAAO,CAAC;IACnD,IAAIA,OAAO,CAACG,IAAI,KAAK,UAAU,EAAE;MAC/BF,OAAO,CAACC,GAAG,CAAC,iBAAiB,EAAEF,OAAO,CAACN,IAAI,CAAC;MAC5CC,OAAO,CAACS,QAAQ,IAAI;QAClB;QACA,MAAMC,WAAW,GAAGD,QAAQ,CAACR,KAAK,CAACU,IAAI,CACrCC,IAAI,IAAIA,IAAI,CAACC,OAAO,KAAKR,OAAO,CAACN,IAAI,CAACc,OACxC,CAAC;QAED,IAAIH,WAAW,EAAE;UACf,OAAOD,QAAQ;QACjB;;QAEA;QACA,MAAMK,QAAQ,GAAG,CACf;UACEC,IAAI,EAAEV,OAAO,CAACN,IAAI,CAACgB,IAAI;UACvBF,OAAO,EAAER,OAAO,CAACN,IAAI,CAACc,OAAO;UAC7BG,SAAS,EAAEX,OAAO,CAACN,IAAI,CAACkB,SAAS;UACjCC,YAAY,EAAEb,OAAO,CAACN,IAAI,CAACmB,YAAY;UACvCC,gBAAgB,EAAEd,OAAO,CAACN,IAAI,CAACoB;QACjC,CAAC,EACD,GAAGV,QAAQ,CAACR,KAAK,CAClB,CAACmB,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;;QAEf,OAAO;UACLnB,KAAK,EAAEa,QAAQ;UACfZ,OAAO,EAAE,KAAK;UACdC,KAAK,EAAE;QACT,CAAC;MACH,CAAC,CAAC;IACJ;EACF,CAAC,EAAE,EAAE,CAAC;EAENT,SAAS,CAAC,MAAM;IACdY,OAAO,CAACC,GAAG,CAAC,oCAAoC,CAAC;IACjD;IACA,MAAMc,YAAY,GAAGC,IAAI,CAACC,MAAM,CAAC,CAAC,CAACC,QAAQ,CAAC,EAAE,CAAC,CAACC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC;;IAE5D;IACA7B,gBAAgB,CAAC8B,SAAS,CAACL,YAAY,EAAEjB,sBAAsB,CAAC;;IAEhE;IACAJ,OAAO,CAACS,QAAQ,KAAK;MACnB,GAAGA,QAAQ;MACXP,OAAO,EAAE;IACX,CAAC,CAAC,CAAC;;IAEH;IACA,OAAO,MAAM;MACXI,OAAO,CAACC,GAAG,CAAC,qCAAqC,CAAC;MAClDX,gBAAgB,CAAC+B,WAAW,CAACN,YAAY,CAAC;IAC5C,CAAC;EACH,CAAC,EAAE,CAACjB,sBAAsB,CAAC,CAAC;;EAE5B;EACAV,SAAS,CAAC,MAAM;IACdY,OAAO,CAACC,GAAG,CAAC,sBAAsB,EAAER,IAAI,CAACE,KAAK,CAAC;EACjD,CAAC,EAAE,CAACF,IAAI,CAACE,KAAK,CAAC,CAAC;EAEhB,OAAOF,IAAI;AACb,CAAC;AAACD,EAAA,CArEID,eAAe;AAuErB,eAAeA,eAAe","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}