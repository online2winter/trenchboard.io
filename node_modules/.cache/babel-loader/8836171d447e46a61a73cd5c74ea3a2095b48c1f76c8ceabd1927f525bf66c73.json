{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.TrezorConnect = exports.CoreInPopup = void 0;\nconst tslib_1 = require(\"tslib\");\nconst events_1 = tslib_1.__importDefault(require(\"events\"));\nconst events_2 = require(\"@trezor/connect/lib/events\");\nconst ERRORS = tslib_1.__importStar(require(\"@trezor/connect/lib/constants/errors\"));\nconst factory_1 = require(\"@trezor/connect/lib/factory\");\nconst debug_1 = require(\"@trezor/connect/lib/utils/debug\");\nconst utils_1 = require(\"@trezor/utils\");\nconst connectSettings_1 = require(\"../connectSettings\");\nconst popup = tslib_1.__importStar(require(\"../popup\"));\nclass CoreInPopup {\n  constructor() {\n    this.eventEmitter = new events_1.default();\n    this._settings = (0, connectSettings_1.parseConnectSettings)();\n    this.logger = (0, debug_1.initLog)('@trezor/connect-web');\n    this.popupManagerLogger = (0, debug_1.initLog)('@trezor/connect-web/popupManager');\n  }\n  logWriterFactory(popupManager) {\n    return {\n      add: message => {\n        popupManager.channel.postMessage({\n          event: events_2.UI_EVENT,\n          type: events_2.IFRAME.LOG,\n          payload: message\n        }, {\n          usePromise: false,\n          useQueue: true\n        });\n      }\n    };\n  }\n  manifest(data) {\n    this._settings = (0, connectSettings_1.parseConnectSettings)(Object.assign(Object.assign({}, this._settings), {\n      manifest: data\n    }));\n  }\n  dispose() {\n    this.eventEmitter.removeAllListeners();\n    this._settings = (0, connectSettings_1.parseConnectSettings)();\n    if (this._popupManager) {\n      this._popupManager.close();\n    }\n    return Promise.resolve(undefined);\n  }\n  cancel(error) {\n    if (this._popupManager) {\n      this._popupManager.emit(events_2.POPUP.CLOSED, error);\n    }\n  }\n  init(settings) {\n    var _a, _b;\n    const oldSettings = (0, connectSettings_1.parseConnectSettings)(Object.assign({}, this._settings));\n    const newSettings = (0, connectSettings_1.parseConnectSettings)(Object.assign(Object.assign({}, this._settings), settings));\n    if (!((_a = newSettings.transports) === null || _a === void 0 ? void 0 : _a.length)) {\n      newSettings.transports = ['BridgeTransport', 'WebUsbTransport'];\n    }\n    newSettings.useCoreInPopup = true;\n    if (typeof window !== 'undefined' && ((_b = window === null || window === void 0 ? void 0 : window.location) === null || _b === void 0 ? void 0 : _b.origin)) {\n      newSettings.origin = window.location.origin;\n    }\n    const equalSettings = JSON.stringify(oldSettings) === JSON.stringify(newSettings);\n    this._settings = newSettings;\n    if (!this._popupManager || !equalSettings) {\n      if (this._popupManager) this._popupManager.close();\n      this._popupManager = new popup.PopupManager(this._settings, {\n        logger: this.popupManagerLogger\n      });\n      (0, debug_1.setLogWriter)(() => this.logWriterFactory(this._popupManager));\n    }\n    this.logger.enabled = !!settings.debug;\n    if (!this._settings.manifest) {\n      throw ERRORS.TypedError('Init_ManifestMissing');\n    }\n    this.logger.debug('initiated');\n    return Promise.resolve();\n  }\n  async call(params) {\n    this.logger.debug('call', params);\n    if (!this._popupManager) {\n      return (0, events_2.createErrorMessage)(ERRORS.TypedError('Init_NotInitialized'));\n    }\n    if (this._settings.popup) {\n      await this._popupManager.request();\n    }\n    const popupClosed = (0, utils_1.createDeferred)();\n    const popupClosedHandler = () => {\n      this.logger.log('Popup closed during initialization');\n      popupClosed.reject(ERRORS.TypedError('Method_Interrupted'));\n    };\n    this._popupManager.once(events_2.POPUP.CLOSED, popupClosedHandler);\n    try {\n      this.logger.debug('call: popup initialing');\n      await Promise.race([popupClosed.promise, this.callInit()]);\n      this.logger.debug('call: popup initialized');\n      const response = await this._popupManager.channel.postMessage({\n        type: events_2.IFRAME.CALL,\n        payload: params\n      });\n      this.logger.debug('call: response: ', response);\n      if (response) {\n        if (this._popupManager && response.success) {\n          this._popupManager.clear();\n        }\n        return {\n          success: response.success,\n          payload: response.payload,\n          device: response.device\n        };\n      }\n      throw ERRORS.TypedError('Method_NoResponse');\n    } catch (error) {\n      this.logger.error('call: error', error);\n      this._popupManager.clear(false);\n      return (0, events_2.createErrorMessage)(error);\n    } finally {\n      this._popupManager.removeListener(events_2.POPUP.CLOSED, popupClosedHandler);\n    }\n  }\n  async callInit() {\n    var _a, _b;\n    if (!this._popupManager) {\n      throw ERRORS.TypedError('Init_NotInitialized');\n    }\n    await this._popupManager.channel.init();\n    if (this._settings.env === 'webextension') {\n      await ((_a = this._popupManager.popupPromise) === null || _a === void 0 ? void 0 : _a.promise);\n      this._popupManager.channel.postMessage({\n        type: events_2.POPUP.INIT,\n        payload: {\n          settings: this._settings,\n          useCore: true\n        }\n      });\n    }\n    await ((_b = this._popupManager.handshakePromise) === null || _b === void 0 ? void 0 : _b.promise);\n  }\n  uiResponse(response) {\n    var _a, _b;\n    const {\n      type,\n      payload\n    } = response;\n    (_b = (_a = this._popupManager) === null || _a === void 0 ? void 0 : _a.channel) === null || _b === void 0 ? void 0 : _b.postMessage({\n      event: events_2.UI_EVENT,\n      type,\n      payload\n    });\n  }\n  renderWebUSBButton() {}\n  requestLogin() {\n    throw ERRORS.TypedError('Method_InvalidPackage');\n  }\n  disableWebUSB() {\n    throw ERRORS.TypedError('Method_InvalidPackage');\n  }\n  requestWebUSBDevice() {\n    throw ERRORS.TypedError('Method_InvalidPackage');\n  }\n}\nexports.CoreInPopup = CoreInPopup;\nconst impl = new CoreInPopup();\nexports.TrezorConnect = (0, factory_1.factory)({\n  eventEmitter: impl.eventEmitter,\n  init: impl.init.bind(impl),\n  call: impl.call.bind(impl),\n  manifest: impl.manifest.bind(impl),\n  requestLogin: impl.requestLogin.bind(impl),\n  uiResponse: impl.uiResponse.bind(impl),\n  cancel: impl.cancel.bind(impl),\n  dispose: impl.dispose.bind(impl)\n});","map":{"version":3,"names":["Object","defineProperty","exports","value","TrezorConnect","CoreInPopup","tslib_1","require","events_1","__importDefault","events_2","ERRORS","__importStar","factory_1","debug_1","utils_1","connectSettings_1","popup","constructor","eventEmitter","default","_settings","parseConnectSettings","logger","initLog","popupManagerLogger","logWriterFactory","popupManager","add","message","channel","postMessage","event","UI_EVENT","type","IFRAME","LOG","payload","usePromise","useQueue","manifest","data","assign","dispose","removeAllListeners","_popupManager","close","Promise","resolve","undefined","cancel","error","emit","POPUP","CLOSED","init","settings","_a","_b","oldSettings","newSettings","transports","length","useCoreInPopup","window","location","origin","equalSettings","JSON","stringify","PopupManager","setLogWriter","enabled","debug","TypedError","call","params","createErrorMessage","request","popupClosed","createDeferred","popupClosedHandler","log","reject","once","race","promise","callInit","response","CALL","success","clear","device","removeListener","env","popupPromise","INIT","useCore","handshakePromise","uiResponse","renderWebUSBButton","requestLogin","disableWebUSB","requestWebUSBDevice","impl","factory","bind"],"sources":["/Users/papa/Desktop/trenchboard/trenchboard.io/node_modules/@trezor/connect-web/lib/impl/core-in-popup.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.TrezorConnect = exports.CoreInPopup = void 0;\nconst tslib_1 = require(\"tslib\");\nconst events_1 = tslib_1.__importDefault(require(\"events\"));\nconst events_2 = require(\"@trezor/connect/lib/events\");\nconst ERRORS = tslib_1.__importStar(require(\"@trezor/connect/lib/constants/errors\"));\nconst factory_1 = require(\"@trezor/connect/lib/factory\");\nconst debug_1 = require(\"@trezor/connect/lib/utils/debug\");\nconst utils_1 = require(\"@trezor/utils\");\nconst connectSettings_1 = require(\"../connectSettings\");\nconst popup = tslib_1.__importStar(require(\"../popup\"));\nclass CoreInPopup {\n    constructor() {\n        this.eventEmitter = new events_1.default();\n        this._settings = (0, connectSettings_1.parseConnectSettings)();\n        this.logger = (0, debug_1.initLog)('@trezor/connect-web');\n        this.popupManagerLogger = (0, debug_1.initLog)('@trezor/connect-web/popupManager');\n    }\n    logWriterFactory(popupManager) {\n        return {\n            add: (message) => {\n                popupManager.channel.postMessage({\n                    event: events_2.UI_EVENT,\n                    type: events_2.IFRAME.LOG,\n                    payload: message,\n                }, { usePromise: false, useQueue: true });\n            },\n        };\n    }\n    manifest(data) {\n        this._settings = (0, connectSettings_1.parseConnectSettings)(Object.assign(Object.assign({}, this._settings), { manifest: data }));\n    }\n    dispose() {\n        this.eventEmitter.removeAllListeners();\n        this._settings = (0, connectSettings_1.parseConnectSettings)();\n        if (this._popupManager) {\n            this._popupManager.close();\n        }\n        return Promise.resolve(undefined);\n    }\n    cancel(error) {\n        if (this._popupManager) {\n            this._popupManager.emit(events_2.POPUP.CLOSED, error);\n        }\n    }\n    init(settings) {\n        var _a, _b;\n        const oldSettings = (0, connectSettings_1.parseConnectSettings)(Object.assign({}, this._settings));\n        const newSettings = (0, connectSettings_1.parseConnectSettings)(Object.assign(Object.assign({}, this._settings), settings));\n        if (!((_a = newSettings.transports) === null || _a === void 0 ? void 0 : _a.length)) {\n            newSettings.transports = ['BridgeTransport', 'WebUsbTransport'];\n        }\n        newSettings.useCoreInPopup = true;\n        if (typeof window !== 'undefined' && ((_b = window === null || window === void 0 ? void 0 : window.location) === null || _b === void 0 ? void 0 : _b.origin)) {\n            newSettings.origin = window.location.origin;\n        }\n        const equalSettings = JSON.stringify(oldSettings) === JSON.stringify(newSettings);\n        this._settings = newSettings;\n        if (!this._popupManager || !equalSettings) {\n            if (this._popupManager)\n                this._popupManager.close();\n            this._popupManager = new popup.PopupManager(this._settings, {\n                logger: this.popupManagerLogger,\n            });\n            (0, debug_1.setLogWriter)(() => this.logWriterFactory(this._popupManager));\n        }\n        this.logger.enabled = !!settings.debug;\n        if (!this._settings.manifest) {\n            throw ERRORS.TypedError('Init_ManifestMissing');\n        }\n        this.logger.debug('initiated');\n        return Promise.resolve();\n    }\n    async call(params) {\n        this.logger.debug('call', params);\n        if (!this._popupManager) {\n            return (0, events_2.createErrorMessage)(ERRORS.TypedError('Init_NotInitialized'));\n        }\n        if (this._settings.popup) {\n            await this._popupManager.request();\n        }\n        const popupClosed = (0, utils_1.createDeferred)();\n        const popupClosedHandler = () => {\n            this.logger.log('Popup closed during initialization');\n            popupClosed.reject(ERRORS.TypedError('Method_Interrupted'));\n        };\n        this._popupManager.once(events_2.POPUP.CLOSED, popupClosedHandler);\n        try {\n            this.logger.debug('call: popup initialing');\n            await Promise.race([popupClosed.promise, this.callInit()]);\n            this.logger.debug('call: popup initialized');\n            const response = await this._popupManager.channel.postMessage({\n                type: events_2.IFRAME.CALL,\n                payload: params,\n            });\n            this.logger.debug('call: response: ', response);\n            if (response) {\n                if (this._popupManager && response.success) {\n                    this._popupManager.clear();\n                }\n                return {\n                    success: response.success,\n                    payload: response.payload,\n                    device: response.device,\n                };\n            }\n            throw ERRORS.TypedError('Method_NoResponse');\n        }\n        catch (error) {\n            this.logger.error('call: error', error);\n            this._popupManager.clear(false);\n            return (0, events_2.createErrorMessage)(error);\n        }\n        finally {\n            this._popupManager.removeListener(events_2.POPUP.CLOSED, popupClosedHandler);\n        }\n    }\n    async callInit() {\n        var _a, _b;\n        if (!this._popupManager) {\n            throw ERRORS.TypedError('Init_NotInitialized');\n        }\n        await this._popupManager.channel.init();\n        if (this._settings.env === 'webextension') {\n            await ((_a = this._popupManager.popupPromise) === null || _a === void 0 ? void 0 : _a.promise);\n            this._popupManager.channel.postMessage({\n                type: events_2.POPUP.INIT,\n                payload: {\n                    settings: this._settings,\n                    useCore: true,\n                },\n            });\n        }\n        await ((_b = this._popupManager.handshakePromise) === null || _b === void 0 ? void 0 : _b.promise);\n    }\n    uiResponse(response) {\n        var _a, _b;\n        const { type, payload } = response;\n        (_b = (_a = this._popupManager) === null || _a === void 0 ? void 0 : _a.channel) === null || _b === void 0 ? void 0 : _b.postMessage({ event: events_2.UI_EVENT, type, payload });\n    }\n    renderWebUSBButton() { }\n    requestLogin() {\n        throw ERRORS.TypedError('Method_InvalidPackage');\n    }\n    disableWebUSB() {\n        throw ERRORS.TypedError('Method_InvalidPackage');\n    }\n    requestWebUSBDevice() {\n        throw ERRORS.TypedError('Method_InvalidPackage');\n    }\n}\nexports.CoreInPopup = CoreInPopup;\nconst impl = new CoreInPopup();\nexports.TrezorConnect = (0, factory_1.factory)({\n    eventEmitter: impl.eventEmitter,\n    init: impl.init.bind(impl),\n    call: impl.call.bind(impl),\n    manifest: impl.manifest.bind(impl),\n    requestLogin: impl.requestLogin.bind(impl),\n    uiResponse: impl.uiResponse.bind(impl),\n    cancel: impl.cancel.bind(impl),\n    dispose: impl.dispose.bind(impl),\n});\n//# sourceMappingURL=core-in-popup.js.map"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}