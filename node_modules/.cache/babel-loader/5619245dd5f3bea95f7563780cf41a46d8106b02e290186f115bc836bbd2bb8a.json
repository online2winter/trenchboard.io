{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.parseConnectSettings = exports.corsValidator = exports.DEFAULT_PRIORITY = void 0;\nconst version_1 = require(\"./version\");\nexports.DEFAULT_PRIORITY = 2;\nconst initialSettings = {\n  configSrc: './data/config.json',\n  version: version_1.VERSION,\n  debug: false,\n  priority: exports.DEFAULT_PRIORITY,\n  trustedHost: true,\n  connectSrc: version_1.DEFAULT_DOMAIN,\n  iframeSrc: `${version_1.DEFAULT_DOMAIN}iframe.html`,\n  popup: false,\n  popupSrc: `${version_1.DEFAULT_DOMAIN}popup.html`,\n  webusbSrc: `${version_1.DEFAULT_DOMAIN}webusb.html`,\n  transports: undefined,\n  pendingTransportEvent: true,\n  env: 'node',\n  lazyLoad: false,\n  timestamp: new Date().getTime(),\n  interactionTimeout: 600,\n  sharedLogger: true,\n  deeplinkUrl: `${version_1.DEFAULT_DOMAIN}deeplink/${version_1.DEEPLINK_VERSION}/`,\n  transportReconnect: true\n};\nconst parseManifest = manifest => {\n  if (!manifest) return;\n  if (typeof manifest.email !== 'string') return;\n  if (typeof manifest.appUrl !== 'string') return;\n  return {\n    email: manifest.email,\n    appUrl: manifest.appUrl\n  };\n};\nconst corsValidator = url => {\n  if (typeof url !== 'string') return;\n  if (url.match(/^https:\\/\\/([A-Za-z0-9\\-_]+\\.)*trezor\\.io\\//)) return url;\n  if (url.match(/^https?:\\/\\/localhost:[58][0-9]{3}\\//)) return url;\n  if (url.match(/^https:\\/\\/([A-Za-z0-9\\-_]+\\.)*sldev\\.cz\\//)) return url;\n  if (url.match(/^https?:\\/\\/([A-Za-z0-9\\-_]+\\.)*trezoriovpjcahpzkrewelclulmszwbqpzmzgub37gbcjlvluxtruqad\\.onion\\//)) return url;\n};\nexports.corsValidator = corsValidator;\nconst parseConnectSettings = (input = {}) => {\n  var _a;\n  const settings = {\n    ...initialSettings\n  };\n  if ('debug' in input) {\n    if (typeof input.debug === 'boolean') {\n      settings.debug = input.debug;\n    } else if (typeof input.debug === 'string') {\n      settings.debug = input.debug === 'true';\n    }\n  }\n  if (input.trustedHost === false) {\n    settings.trustedHost = input.trustedHost;\n  }\n  if (typeof input.connectSrc === 'string' && ((_a = input.connectSrc) === null || _a === void 0 ? void 0 : _a.startsWith('http'))) {\n    settings.connectSrc = (0, exports.corsValidator)(input.connectSrc);\n  } else if (settings.trustedHost) {\n    settings.connectSrc = input.connectSrc;\n  }\n  const src = settings.connectSrc || version_1.DEFAULT_DOMAIN;\n  settings.iframeSrc = `${src}iframe.html`;\n  settings.popupSrc = `${src}popup.html`;\n  settings.webusbSrc = `${src}webusb.html`;\n  settings.deeplinkUrl = `${src}deeplink/${version_1.DEEPLINK_VERSION}/`;\n  if (typeof input.transportReconnect === 'boolean') {\n    settings.transportReconnect = input.transportReconnect;\n  }\n  if (Array.isArray(input.transports)) {\n    settings.transports = input.transports;\n  }\n  if (typeof input.popup === 'boolean') {\n    settings.popup = input.popup;\n  }\n  if (typeof input.lazyLoad === 'boolean') {\n    settings.lazyLoad = input.lazyLoad;\n  }\n  if (typeof input.pendingTransportEvent === 'boolean') {\n    settings.pendingTransportEvent = input.pendingTransportEvent;\n  }\n  if (typeof input.extension === 'string') {\n    settings.extension = input.extension;\n  }\n  if (typeof input.env === 'string') {\n    settings.env = input.env;\n  }\n  if (typeof input.timestamp === 'number') {\n    settings.timestamp = input.timestamp;\n  }\n  if (typeof input.interactionTimeout === 'number') {\n    settings.interactionTimeout = input.interactionTimeout;\n  }\n  if (typeof input.manifest === 'object') {\n    settings.manifest = parseManifest(input.manifest);\n  }\n  if (typeof input.sharedLogger === 'boolean') {\n    settings.sharedLogger = input.sharedLogger;\n  }\n  if (typeof input.coreMode === 'string' && ['auto', 'popup', 'iframe'].includes(input.coreMode)) {\n    settings.coreMode = input.coreMode;\n  }\n  if (typeof input._extendWebextensionLifetime === 'boolean') {\n    settings._extendWebextensionLifetime = input._extendWebextensionLifetime;\n  }\n  if (typeof input._sessionsBackgroundUrl === 'string' || input._sessionsBackgroundUrl === null) {\n    settings._sessionsBackgroundUrl = input._sessionsBackgroundUrl;\n  }\n  if (typeof input.binFilesBaseUrl === 'string') {\n    settings.binFilesBaseUrl = input.binFilesBaseUrl;\n  }\n  if (typeof input.enableFirmwareHashCheck === 'boolean') {\n    settings.enableFirmwareHashCheck = Boolean(input.enableFirmwareHashCheck);\n  }\n  return settings;\n};\nexports.parseConnectSettings = parseConnectSettings;","map":{"version":3,"names":["Object","defineProperty","exports","value","parseConnectSettings","corsValidator","DEFAULT_PRIORITY","version_1","require","initialSettings","configSrc","version","VERSION","debug","priority","trustedHost","connectSrc","DEFAULT_DOMAIN","iframeSrc","popup","popupSrc","webusbSrc","transports","undefined","pendingTransportEvent","env","lazyLoad","timestamp","Date","getTime","interactionTimeout","sharedLogger","deeplinkUrl","DEEPLINK_VERSION","transportReconnect","parseManifest","manifest","email","appUrl","url","match","input","_a","settings","startsWith","src","Array","isArray","extension","coreMode","includes","_extendWebextensionLifetime","_sessionsBackgroundUrl","binFilesBaseUrl","enableFirmwareHashCheck","Boolean"],"sources":["/Users/papa/Desktop/trenchboard/trenchboard.io/node_modules/@trezor/connect/lib/data/connectSettings.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.parseConnectSettings = exports.corsValidator = exports.DEFAULT_PRIORITY = void 0;\nconst version_1 = require(\"./version\");\nexports.DEFAULT_PRIORITY = 2;\nconst initialSettings = {\n    configSrc: './data/config.json',\n    version: version_1.VERSION,\n    debug: false,\n    priority: exports.DEFAULT_PRIORITY,\n    trustedHost: true,\n    connectSrc: version_1.DEFAULT_DOMAIN,\n    iframeSrc: `${version_1.DEFAULT_DOMAIN}iframe.html`,\n    popup: false,\n    popupSrc: `${version_1.DEFAULT_DOMAIN}popup.html`,\n    webusbSrc: `${version_1.DEFAULT_DOMAIN}webusb.html`,\n    transports: undefined,\n    pendingTransportEvent: true,\n    env: 'node',\n    lazyLoad: false,\n    timestamp: new Date().getTime(),\n    interactionTimeout: 600,\n    sharedLogger: true,\n    deeplinkUrl: `${version_1.DEFAULT_DOMAIN}deeplink/${version_1.DEEPLINK_VERSION}/`,\n    transportReconnect: true,\n};\nconst parseManifest = (manifest) => {\n    if (!manifest)\n        return;\n    if (typeof manifest.email !== 'string')\n        return;\n    if (typeof manifest.appUrl !== 'string')\n        return;\n    return {\n        email: manifest.email,\n        appUrl: manifest.appUrl,\n    };\n};\nconst corsValidator = (url) => {\n    if (typeof url !== 'string')\n        return;\n    if (url.match(/^https:\\/\\/([A-Za-z0-9\\-_]+\\.)*trezor\\.io\\//))\n        return url;\n    if (url.match(/^https?:\\/\\/localhost:[58][0-9]{3}\\//))\n        return url;\n    if (url.match(/^https:\\/\\/([A-Za-z0-9\\-_]+\\.)*sldev\\.cz\\//))\n        return url;\n    if (url.match(/^https?:\\/\\/([A-Za-z0-9\\-_]+\\.)*trezoriovpjcahpzkrewelclulmszwbqpzmzgub37gbcjlvluxtruqad\\.onion\\//))\n        return url;\n};\nexports.corsValidator = corsValidator;\nconst parseConnectSettings = (input = {}) => {\n    var _a;\n    const settings = { ...initialSettings };\n    if ('debug' in input) {\n        if (typeof input.debug === 'boolean') {\n            settings.debug = input.debug;\n        }\n        else if (typeof input.debug === 'string') {\n            settings.debug = input.debug === 'true';\n        }\n    }\n    if (input.trustedHost === false) {\n        settings.trustedHost = input.trustedHost;\n    }\n    if (typeof input.connectSrc === 'string' && ((_a = input.connectSrc) === null || _a === void 0 ? void 0 : _a.startsWith('http'))) {\n        settings.connectSrc = (0, exports.corsValidator)(input.connectSrc);\n    }\n    else if (settings.trustedHost) {\n        settings.connectSrc = input.connectSrc;\n    }\n    const src = settings.connectSrc || version_1.DEFAULT_DOMAIN;\n    settings.iframeSrc = `${src}iframe.html`;\n    settings.popupSrc = `${src}popup.html`;\n    settings.webusbSrc = `${src}webusb.html`;\n    settings.deeplinkUrl = `${src}deeplink/${version_1.DEEPLINK_VERSION}/`;\n    if (typeof input.transportReconnect === 'boolean') {\n        settings.transportReconnect = input.transportReconnect;\n    }\n    if (Array.isArray(input.transports)) {\n        settings.transports = input.transports;\n    }\n    if (typeof input.popup === 'boolean') {\n        settings.popup = input.popup;\n    }\n    if (typeof input.lazyLoad === 'boolean') {\n        settings.lazyLoad = input.lazyLoad;\n    }\n    if (typeof input.pendingTransportEvent === 'boolean') {\n        settings.pendingTransportEvent = input.pendingTransportEvent;\n    }\n    if (typeof input.extension === 'string') {\n        settings.extension = input.extension;\n    }\n    if (typeof input.env === 'string') {\n        settings.env = input.env;\n    }\n    if (typeof input.timestamp === 'number') {\n        settings.timestamp = input.timestamp;\n    }\n    if (typeof input.interactionTimeout === 'number') {\n        settings.interactionTimeout = input.interactionTimeout;\n    }\n    if (typeof input.manifest === 'object') {\n        settings.manifest = parseManifest(input.manifest);\n    }\n    if (typeof input.sharedLogger === 'boolean') {\n        settings.sharedLogger = input.sharedLogger;\n    }\n    if (typeof input.coreMode === 'string' &&\n        ['auto', 'popup', 'iframe'].includes(input.coreMode)) {\n        settings.coreMode = input.coreMode;\n    }\n    if (typeof input._extendWebextensionLifetime === 'boolean') {\n        settings._extendWebextensionLifetime = input._extendWebextensionLifetime;\n    }\n    if (typeof input._sessionsBackgroundUrl === 'string' || input._sessionsBackgroundUrl === null) {\n        settings._sessionsBackgroundUrl = input._sessionsBackgroundUrl;\n    }\n    if (typeof input.binFilesBaseUrl === 'string') {\n        settings.binFilesBaseUrl = input.binFilesBaseUrl;\n    }\n    if (typeof input.enableFirmwareHashCheck === 'boolean') {\n        settings.enableFirmwareHashCheck = Boolean(input.enableFirmwareHashCheck);\n    }\n    return settings;\n};\nexports.parseConnectSettings = parseConnectSettings;\n//# sourceMappingURL=connectSettings.js.map"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}